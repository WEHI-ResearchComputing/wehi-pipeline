definitions:

  # Modules that should be loaded prior to execution
  modules:
    type: array
    items:
      type: string

  # Output files generated by this step
  outputs:
    type: array
    items:
      type: object
      properties:
        name:
          type: string
        type:
          enum:
            - BAM
            - regular
        destination:
          type: string

  # Commands whose output can be placed in to variables
  precommands:
    type: array
    items:
      type: object
      required: [command, variable]
      properties:
        command:
          type: string
        variable:
          type: string

  pipeline-definition:
    type: object

    required: [name, fastqs, steps]

    properties:

      name:
        type: string

      description:
        type: string

      resources:
        type: object
        properties:
          queue:
            type: string
          ppn:
            type: integer
          nodes:
            type: integer
          mem:
            type: string

      fastqs:
        type: object
        required: [path, pattern]
        properties:
          paired:
            type: boolean
          path:
            type: string
          pattern:
            type: string
          start-at:
            type: integer
          finish-at:
            type: integer

      references:
        type: array
        items:
          type: object
          required: [name, path]
          properties:
            name:
              type: string
            path:
              type: string

      destinations:
        type: array
        items:
          type: object
          required: [name, path]
          properties:
            name:
              type: string
            path:
              type: string

      steps:
        type: array
        items:
          type: object
          properties:
            generic:
              type: object
              required: [name, commands]
              properties:
                name:
                  type: string

                commands:
                  type: array
                  items:
                    type: string

              outputs:
                $ref: "#/definitions/outputs"
              precommands:
                $ref: "#/definitions/precommands"
              modules:
                $ref: "#/definitions/modules"

            dummy-file:
              type: object
              required: [name, file]
              properties:
                name:
                  type: string

                file:
                  type: object
                  required: [file-name]
                  properties:
                    file-name:
                      type: string
                    content:
                      type: string

              outputs:
                $ref: "#/definitions/outputs"
              precommands:
                $ref: "#/definitions/precommands"

